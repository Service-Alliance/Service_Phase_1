<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>

<div class="container-fluid">
    <div id="wrapper">
        <%= render partial: "partials/jobs_sidebar" %>
        <div id="page-content-wrapper">

            <% if notice %>
            <div class="alert alert-success" role="alert"><%= notice %></div>
            <% end %>

            <div class="col-xs-12">
                <div>
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active">
                            <a href="#notes" aria-controls="notes" role="tab" data-toggle="tab">Take Notes</a>
                        </li>
                        <li role="presentation">
                            <a href="#activity" aria-controls="activity" role="tab" data-toggle="tab">Add Activity</a>
                        </li>
                        <li role="presentation">
                            <a href="#upload" aria-controls="upload" role="tab" data-toggle="tab">Upload Files</a>
                        </li>

                    </ul>

                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="notes">...</div>
                        <div role="tabpanel" class="tab-pane" id="activity">
                            <div class="col-xs-12">
                                <%= form_for [@job, @scheduler], remote: true do |f| %>
                                <div class="row">
                                    <div class="col-sm-3">
                                        Calendar Integration
                                    </div>
                                    <div class="col-sm-9">
                                        <div class="row">
                                            <div class="col-xs-12">
                                                <%= f.text_field :title, placeholder: "Description", class:"form-control" %>
                                            </div>
                                            <div class="col-xs-4 margin-top-2">
                                                <%= f.label :event_date, "Date" %><br>
                                                <%= f.text_field :event_date, class:"form-control datePicker" %>
                                            </div>
                                            <div class="col-xs-4 margin-top-2">
                                                <%= f.label :start_time %><br>
                                                <%= f.text_field :start_time, class:"form-control timepicker" %>
                                            </div>
                                            <div class="col-xs-4 margin-top-2">
                                                <%= f.label :end_time %><br>
                                                <%= f.text_field :end_time, class:"form-control timepicker" %>
                                            </div>

                                            <div class="col-xs-12 margin-top-2">
                                                <%= f.text_area :notes, class: "form-control", placeholder: "Notes" %>
                                            </div>
                                            <div class="col-xs-12 margin-top-2">
                                                <%= f.label :assigned_to_user_id %><br>
                                                <%= f.collection_select :assigned_to_user_id, User.all, :id, :full_name, {prompt: true},  { class: 'form-control'} %>
                                            </div>
                                            <div class="col-xs-3 col-xs-offset-9">
                                                <%= f.submit "Add", class: "btn btn-primary" %>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                                <% end %>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="upload">
                            <div class="col-xs-12">
                                <%= form_for [@job, @upload], remote: true do |f| %>
                                <% if @upload.errors.any? %>
                                <div id="error_explanation">
                                    <h2><%= pluralize(@upload.errors.count, "error") %>
                                        prohibited this upload from being saved:</h2>

                                    <ul>
                                        <% @upload.errors.full_messages.each do |message| %>
                                        <li><%= message %></li>
                                        <% end %>
                                    </ul>
                                </div>
                                <% end %>
                                <div class="col-sm-6 col-sm-offset-3">
                                    <div class="form-group">
                                        <%= f.label :upload_category_id %><br>
                                        <%= f.collection_select :upload_category_id, UploadCategory.all, :id, :name, {:prompt => 'Select an Upload Type'},  { class: 'form-control'} %>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-sm-offset-3">
                                    <%= f.label :upload %><br>
                                    <%= f.file_field :upload %>
                                </div>
                                <br>
                                <div class="col-sm-6 col-sm-offset-3 text-center margin-top-3">
                                    <%= f.submit class: "btn btn-primary" %>
                                </div>
                                <% end %>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div class="col-xs-12 margin-top-5">
                <h3 class="text-center">Planned</h3>
                <% @job.schedulers.each do |scheduler| %>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title"><%= scheduler.title %></h3>
                    </div>
                    <div class="panel-body">
                        <%= scheduler.start_time %> ~ <%= scheduler.assigned_to_user.try(:full_name) %>
                    </div>
                </div>
                <% end %>
            </div>
        </div>
    </div>
</div>
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });

    flatpickr(".datePicker", {
        enableTime: false,
        // create an extra input solely for display purposes
        altInput: true,
        altFormat: "F j, Y"
    });

    $('.timepicker').timepicker({
        timeFormat: 'h:mm p',
        interval: 30,
        minTime: '5',
        maxTime: '8:00pm',
        dynamic: false,
        dropdown: true,
        scrollbar: true
    });
</script>
