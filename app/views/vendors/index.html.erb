<div class="container-fluid">
    <p id="notice"><%= notice %></p>

    <div class="row">

        <div class="col-lg-12">
          <% if Vendor.can_edit?(current_user) %>
            <%= link_to 'New Vendor', new_vendor_path, class: "btn btn-success margin-top-2 margin-bottom-2 margin-left-2" %>
          <% end %>
            <div class="panel panel-default">
                <div class="panel-heading">Vendors</div>
                <div class="panel-body">
                    <table
                        data-toggle="table"
                        data-url="vendors"
                        data-show-refresh="true"
                        data-show-toggle="true"
                        data-show-columns="true"
                        data-search="true"
                        data-flat="true"
                        data-select-item-name="toolbar1"
                        data-pagination="true"
                        data-sort-name="id"
                        data-sort-order="asc"
                        data-row-style="RowFormatter">
                        <thead>
                            <tr>
                                <th data-field="state" data-checkbox="true">Vendor ID</th>
                                <th data-field="id" data-sortable="true" data-formatter="LinkFormatter">Vendor ID</th>
                                <th data-field="name" data-sortable="true">Name</th>
                                <th data-field="category_type" data-sortable="true">Category Type</th>
                                <th data-field="contact" data-sortable="true">Contact</th>
                                <th data-field="phone" data-sortable="true">Phone</th>
                                <th data-field="cellphone" data-sortable="true">Cellphone</th>
                                <th data-field="fax" data-sortable="true">Fax</th>
                                <th data-field="address" data-sortable="true">Address</th>
                                <th data-field="wc" data-sortable="true">WC</th>
                                <th data-field="liability" data-sortable="true">Liability</th>
                                <th data-field="pollution" data-sortable="true">Pollution</th>
                                <th data-field="auto" data-sortable="true">Auto</th>
                                <th data-field="w9" data-sortable="true">W9</th>
                                <th data-field="independent_contractor_agreement" data-sortable="true">Independent Contractor Agreement</th>
                                <th data-field="email" data-sortable="true">Email</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
  function RowFormatter(row, index) {
    var auto = Date.parse(row.auto);
    var liability = Date.parse(row.liability);
    var pollution = Date.parse(row.pollution);
    var wc = Date.parse(row.wc);
    var today = Date.now()
    var expired = auto < today || liability < today || pollution < today || wc < today;
    var cls = expired ? 'danger' : '';
    return { classes: cls, css: '' };
  }
</script>
